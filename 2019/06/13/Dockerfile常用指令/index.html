
<!DOCTYPE html>
<html lang class="loading">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dockerfile常用指令 - xiyou</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate">
    <meta name="keywords" content="xiyou,"> 
    <meta name="description" content="1.ADD复制文件格式：
ADD &amp;lt;src&amp;gt;... &amp;lt;dest&amp;gt;  
ADD [&amp;quot;&amp;lt;src&amp;gt;&amp;quot;,... &amp;quot;&amp;lt;dest&amp;gt;&amp;,"> 
    <meta name="author" content="xiyou"> 
    <link rel="alternative" href="atom.xml" title="xiyou" type="application/atom+xml"> 
    <link rel="icon" href="/blog/img/favicon.png"> 
    
    <link rel="stylesheet" href="/blog/css/diaspora.css">
	<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
         (adsbygoogle = window.adsbygoogle || []).push({
              google_ad_client: "ca-pub-8691406134231910",
              enable_page_level_ads: true
         });
    </script>
    <script async custom-element="amp-auto-ads" src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js">
    </script>
</head>
</html>
<body class="loading">
    <span id="config-title" style="display:none">xiyou</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://xiyou13921.gitee.io/blog"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">Dockerfile常用指令</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class="main">
        <h1 class="title">Dockerfile常用指令</h1>
        <div class="stuff">
            <span>六月 13, 2019</span>
            

        </div>
        <div class="content markdown">
            <h3 id="1-ADD复制文件"><a href="#1-ADD复制文件" class="headerlink" title="1.ADD复制文件"></a>1.ADD复制文件</h3><pre><code>格式：
ADD &lt;src&gt;... &lt;dest&gt;  
ADD [&quot;&lt;src&gt;&quot;,... &quot;&lt;dest&gt;&quot;]
从src目录复制文件到容器的dest。其中src可以是Dockerfile所在目录的相对路径，也可以是一个URL，还可以是一个压缩包
注意：
    1.src必须在构建的上下文内，不能使用例如：ADD ../something /something这样的命令，因为docker build命令会首先将上下文路径和其子目录发送到docker daemon。
    2.如果src是一个URL，同时dest不以斜杆结尾，dest将会被视为文件，src对应内容文件将会被下载到dest。
    3.如果src是一个URL，同时dest以斜杆结尾，dest将被视为目录，src对应内容将会被下载到dest目录。
    4.如果src是一个URL，那么整个目录下的内容将会被复制，包括文件系统元数据。
    5.如果文件是可识别的压缩包格式，则docker会自动解压。
示例：
ADD microservice-discovery-eureka-0.0.1-SNAPSHOT.jar app.jar</code></pre><a id="more"></a>
<h3 id="2-ARG设置构建参数"><a href="#2-ARG设置构建参数" class="headerlink" title="2.ARG设置构建参数"></a>2.ARG设置构建参数</h3><pre><code>ARG指令用于设置构建参数，类似于ENV。和ENV不同的是，ARG设置的是构建时的环境变量，在容器运行时是不会存在这些变量的。
格式：    
ARG &lt;name&gt;[=&lt;default value&gt;]
示例：
ARG user1=someuser</code></pre><h3 id="3-CMD容器启动命令"><a href="#3-CMD容器启动命令" class="headerlink" title="3.CMD容器启动命令"></a>3.CMD容器启动命令</h3><pre><code>CMD指令用于为执行容器提供默认值。每个Dockerfile只有一个CMD命令，如果指定了多个CMD命令，那么只有最后一条会被执行，如果启动容器时指定了运行的命令，则会覆盖掉CMD指定的命令
格式：    
CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;](推荐使用)
CMD [&quot;param1&quot;,&quot;param2&quot;](为ENTRYPOINT指令提供预设参数)
CMD command param1 param2(在shell中执行)
示例：
CMD echo &quot;This is a test.&quot; | wc -</code></pre><h3 id="4-COPY复制文件"><a href="#4-COPY复制文件" class="headerlink" title="4.COPY复制文件"></a>4.COPY复制文件</h3><pre><code>格式：
COPY &lt;src&gt;... &lt;dest&gt;  
COPY [&quot;&lt;src&gt;&quot;,... &quot;&lt;dest&gt;&quot;]
从src目录复制文件到容器的dest。COPY指令与ADD指令类似，COPY不支持URL和压缩包。</code></pre><h3 id="5-ENTRYPOINT入口点"><a href="#5-ENTRYPOINT入口点" class="headerlink" title="5.ENTRYPOINT入口点"></a>5.ENTRYPOINT入口点</h3><pre><code>格式：
CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]
CMD command param1 param2
ENTRYPOINT和CMD指令的目的一样，都是指定Docker容器启动时执行的命令，可多次设置，但只有最后一个有效。</code></pre><h3 id="6-ENV设置环境变量"><a href="#6-ENV设置环境变量" class="headerlink" title="6.ENV设置环境变量"></a>6.ENV设置环境变量</h3><pre><code>ENV指令用于设置环境变量。
格式：
ENV &lt;key&gt; &lt;value&gt;
ENV &lt;key&gt;=&lt;value&gt; ...
示例：
ENV JAVA_HOME /path/to/java</code></pre><h3 id="7-EXPOSE声明暴露的端口"><a href="#7-EXPOSE声明暴露的端口" class="headerlink" title="7.EXPOSE声明暴露的端口"></a>7.EXPOSE声明暴露的端口</h3><pre><code>EXPOSE指令用于声明在运行时容器提供服务的端口.
格式：
EXPOSE &lt;port&gt; [&lt;port&gt;...]
注意：
    这只是一个声明，运行时并不会因为该声明就打开相应端口。该指令的作用主要是帮助镜像使用者理解该镜像服务的守护端口；其次是当运行时使用随机映射时，会自动映射EXPOSE端口。
示例：
#声明暴露一个端口示例
EXPOSE port1
#相应的运行容器使用的命令
docker run -p port1 image
#也可以使用-P选项启动
docker run -P image

#声明暴露多个端口示例
EXPOSE port1 port2 port3
#相应的运行容器使用的命令
docker run -p port1 -p port2 -p port3 image
#也可以指定需要映射到宿主机器上的端口号
docker run -p host_port1:port1 -p host_port2:port2 -p host_port3:port3 image</code></pre><h3 id="8-FROM指定基础镜像"><a href="#8-FROM指定基础镜像" class="headerlink" title="8.FROM指定基础镜像"></a>8.FROM指定基础镜像</h3><pre><code>使用FROM指令指定基础镜像，FROM指令有点像Java里面的extends关键字。需要注意的是，FROM指令必须指定且需要写在其他指令之前。FROM指令之后的所有指令都依赖于该指令所指定的镜像。
格式：
FROM &lt;image&gt;
FROM &lt;image&gt;:&lt;tag&gt;
FROM &lt;image&gt;@&lt;digest&gt;</code></pre><h3 id="9-LABEL为镜像添加元数据"><a href="#9-LABEL为镜像添加元数据" class="headerlink" title="9.LABEL为镜像添加元数据"></a>9.LABEL为镜像添加元数据</h3><pre><code>格式：
LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...
使用 “&quot;” 和 “\” 转换命令行
示例：
LABEL &quot;com.example.vender&quot;=&quot;ACME Incorporated&quot;
LABEL com.example.label-with-value=&quot;foo&quot;
LABEL version=&quot;1.0&quot;
LABEL description=&quot;This text illustrate \
that label-values can span multiple lines.&quot;</code></pre><h3 id="10-MAINTAINER指定维护者的信息"><a href="#10-MAINTAINER指定维护者的信息" class="headerlink" title="10.MAINTAINER指定维护者的信息"></a>10.MAINTAINER指定维护者的信息</h3><pre><code>MAINTAINER指令用于指定维护者的信息，用于为Dockerfile署名
格式：
MAINTAINER &lt;name&gt;
示例：
MAINTAINER 张三&lt;eacdy000@126.com&gt;</code></pre><h3 id="11-RUN执行命令"><a href="#11-RUN执行命令" class="headerlink" title="11.RUN执行命令"></a>11.RUN执行命令</h3><pre><code>格式：
RUN &lt;command&gt;
RUN [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]
RUN &lt;command&gt;在shell终端中运行，在Linux中默认是/bin/sh -c，在Windows中是cmd /s /c，使用这种格式，就像直接在命令行中输入命令一样。
RUN [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]使用exec执行，这种方式类似于函数调用。指定其他终端可以通过该方式操作，例如： RUN [&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;echo hello&quot;]，该方式必须使用双引号`&quot;`而不能使用单引号`&apos;`，因为该方式会被转换成一个JSON数组。</code></pre><h3 id="12-USER设置用户"><a href="#12-USER设置用户" class="headerlink" title="12.USER设置用户"></a>12.USER设置用户</h3><pre><code>该指令用于设置启动镜像时的用户或者UID，写在该指令后的RUN、CMD以及ENTRYPOINT指令都将使用该用户执行命令
格式：
USER 用户名
示例：
USER daemon</code></pre><h3 id="13-VALUME指定挂载点"><a href="#13-VALUME指定挂载点" class="headerlink" title="13.VALUME指定挂载点"></a>13.VALUME指定挂载点</h3><pre><code>该指令使容器中的一个目录具有持久化存储的功能，该目录可被容器本身使用，也可以共享给其他容器。当容器中的应用有持久化数据的需求时可以在Dockerfile中使用该指令。
格式：
VALUME [&quot;/data&quot;]
示例：
VALUME /data</code></pre><h3 id="14-WORKDIR指定工作目录"><a href="#14-WORKDIR指定工作目录" class="headerlink" title="14.WORKDIR指定工作目录"></a>14.WORKDIR指定工作目录</h3><pre><code>格式：
WORKDIR /path/to/workdir
切换目录指令，类似于cd命令，写在该指令后的RUN，CMD以及ENTRYPOINT指令都将该目录作为当前目录，并执行相应的命令。</code></pre><h3 id="15-其他"><a href="#15-其他" class="headerlink" title="15.其他"></a>15.其他</h3><pre><code>前往`https://docs.docker.com/engine/reference/builder/`进行扩展阅读</code></pre>
            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src>
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
    <div id="gitalk-container" class="comment link" data-enable="false" data-ae="false" data-ci data-cs data-r data-o data-a data-d="false">查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>

<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/blog/js/plugin.js"></script>
<script src="/blog/js/typed.js"></script>
<script src="/blog/js/diaspora.js"></script>
<link rel="stylesheet" href="/blog/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/blog/photoswipe/default-skin/default-skin.css">
<script src="/blog/photoswipe/photoswipe.min.js"></script>
<script src="/blog/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
